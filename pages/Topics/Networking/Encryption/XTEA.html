<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>XTEA &mdash; Wiki  documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/algolia.css" type="text/css" />
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/rtd_dark.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/js/external-hyperlinks.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Knowledge" href="../../../Knowledge/index.html" />
    <link rel="prev" title="IPE" href="IPE.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../../index.html" class="icon icon-home"> Wiki
            <img src="../../../../_static/128_icon.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Wiki</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Topics</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../Encryption/index.html">Encryption</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Encryption/hybrid_cript.html">HybridCrypt (Type 4)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Encryption/hybrid_cript.html#summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Encryption/hybrid_cript.html#distinction">Distinction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Encryption/hybrid_cript.html#usage">Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Encryption/hybrid_cript.html#composition">Composition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Encryption/hybrid_cript_plus.html">HybridCrypt+ (Type 5)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Encryption/hybrid_cript_plus.html#summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Encryption/hybrid_cript_plus.html#distinction">Distinction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Encryption/hybrid_cript_plus.html#composition">Composition</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Formats/index.html">Formats</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Formats/Map/index.html">Map</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Map/Chunk/index.html">Chunk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Map/index.html#directory-composition">Directory Composition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Formats/Scripts/index.html">Script</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Scripts/Base.html">Script Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Scripts/Property.html">Property</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Scripts/Sub.html">Sub Format (.sub)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Formats/Entity/index.html">Entity</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Entity/Models/index.html">Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Entity/Motion.html">Motion Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Entity/Effect.html">Effect Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Entity/Sound.html">Sound Data</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Formats/Pack/index.html">Pack</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Pack/eter.html">EterPack</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Formats/Protos/index.html">Protos</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Protos/Item.html">Item Proto</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Protos/Mob.html">Mob Proto</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Formats/Deprecated/index.html">Deprecated</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Deprecated/texture_caching.html">DDS Texture Caching</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Formats/Encrypted-Object.html">Encrypted Object</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Encrypted-Object.html#header">Header</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Encrypted-Object.html#data-compression">Data Compression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Encrypted-Object.html#data-encryption">Data Encryption</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Networking</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../Flow.html">Flow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Flow.html#concept">Concept</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Phases.html">Phases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Phases.html#login-phase">Login Phase</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Synchronization/index.html">Synchronization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Synchronization/Handshake.html">Handshake</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Synchronization/IPE.html">IPE</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Data/index.html">Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Data/Packets/index.html">Packets</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Encryption</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="Overview.html">Encryption</a></li>
<li class="toctree-l4"><a class="reference internal" href="Encryption.html">Network Encryption</a></li>
<li class="toctree-l4"><a class="reference internal" href="IPE.html">IPE</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">XTEA</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../Knowledge/index.html">Knowledge</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../Knowledge/Compatibility/index.html">Compatibility</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../Knowledge/Compatibility/improvements.html">Possible Improvements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Knowledge/Compatibility/improvements.html#id1"></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../Knowledge/Compatibility/index.html#compatible-platforms">Compatible Platforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Knowledge/Compatibility/index.html#client">Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Knowledge/Compatibility/index.html#server">Server</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../Knowledge/Compatibility/index.html#freebsd">FreeBSD</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Knowledge/Compatibility/index.html#bsd-extensions-file-monitoring">BSD Extensions/File Monitoring</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../Knowledge/Compatibility/index.html#windows">Windows</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../Knowledge/Tutorials/index.html">Tutorials</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../Knowledge/ThirdParty/index.html">Third Party</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../Knowledge/ThirdParty/Requirements.html">Tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Knowledge/ThirdParty/Requirements.html#introduction">Introduction</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../Knowledge/ThirdParty/libraries.html">Third Party Libraries</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../Knowledge/ThirdParty/libraries.html#introduction">Introduction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Knowledge/ThirdParty/libraries.html#client">Client</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Knowledge/ThirdParty/libraries.html#server">Server</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../Knowledge/ThirdParty/dependencies.html">Dependencies</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Knowledge/ThirdParty/dependencies.html#client-binary">Client Binary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Knowledge/ThirdParty/dependencies.html#directx-8-and-windows-32bit-native-apis">DirectX 8 and Windows 32bit native APIs</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">History</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../History/index.html">About</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../History/Network.html">Network</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../History/Network.html#encryption">Encryption</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../History/Network.html#methods">Methods</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../About/index.html">About</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../About/Contributing.html">Contributing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../About/Contributing.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../About/Contributing.html#content">Content</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../About/Contributing.html#proposing-changes">Proposing Changes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../About/Contributing.html#pull-requests-approval">Pull Requests / Approval</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../About/Contributing.html#licensing">Licensing</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Wiki</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">Topics</a> &raquo;</li>
          <li><a href="../index.html">Networking</a> &raquo;</li>
          <li><a href="index.html">Encryption</a> &raquo;</li>
      <li>XTEA</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/Metin2-Dev/wiki-beta-dev/blob/beta/docs/pages/Topics/Networking/Encryption/XTEA.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="xtea">
<h1>XTEA<a class="headerlink" href="#xtea" title="Permalink to this heading"></a></h1>
<div class="section" id="xtea-encryption">
<h2>XTEA Encryption<a class="headerlink" href="#xtea-encryption" title="Permalink to this heading"></a></h2>
<p>This encryption is divided in two phases, Auth Phase and Game Phase.</p>
<p>Every packet that uses this encryption gets encrypted and decrypted with the
TEA algorithm and a TEA key.</p>
<p>The encryption works by having two XTEA keys, the first one
(Referred as Auth phase key) is a static 16 bytes key used in the first stage
of the communication, this key will be used until a Client has attempted to log
in into a Channel (any core that is not an Auth one) with the login key method.</p>
<p>Once the client sends a Login packet to a channel, it will also send it’s
encryptation keys where the server’s encryptation keys will be computed.
The keys will be changed IMMEDIATLY, no extra packet or data is needed to
change the keys.</p>
<p>This generated second keys are referred as Game phase keys.</p>
<p>The client computes it’s decryptation key (likewise, the server computes it’s
encryptation key) by performing an XTEA of the encryptation key
(decryptation key for the server) with a Special key.</p>
<p>Key list</p>
<div class="section" id="auth-phase-keys">
<h3>Auth Phase keys<a class="headerlink" href="#auth-phase-keys" title="Permalink to this heading"></a></h3>
<p>Auth phase keys (Both for encrypting and decrypting) Usage 	First number 	Second number 	Notes</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Region</p></th>
<th class="head"><p>Key 1</p></th>
<th class="head"><p>Key 2</p></th>
<th class="head"><p>ASCII Representation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Worldwide</p></td>
<td><p>0x7473657474736574</p></td>
<td><p>0x7473657474736574</p></td>
<td><p>testtesttesttest</p></td>
</tr>
<tr class="row-odd"><td><p>European servers</p></td>
<td><p>0x6867666538373635</p></td>
<td><p>0x6463626134333231</p></td>
<td><p>1234abcd5678efgh</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="special-keys">
<h3>Special keys<a class="headerlink" href="#special-keys" title="Permalink to this heading"></a></h3>
<p>The Special key was generated by the Client and the Server during
the login into the Game core, it is known that in very old version of M2
(such as the Korean 2003 beta)
the following hardcoded key might be used rather than a random generated one.</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Special keys Usage</p></th>
<th class="head"><p>First number</p></th>
<th class="head"><p>Second number</p></th>
<th class="head"><p>ASCII Representation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Korean server</p></td>
<td><p>0x6a6c48747854794a</p></td>
<td><p>0x726f484a566c4a48</p></td>
<td><p>JyTxtHljHJlVJHor</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="IPE.html" class="btn btn-neutral float-left" title="IPE" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../../Knowledge/index.html" class="btn btn-neutral float-right" title="Knowledge" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018-2022.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
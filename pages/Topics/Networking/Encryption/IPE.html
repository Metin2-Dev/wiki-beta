<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>IPE &mdash; Wiki  documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/algolia.css" type="text/css" />
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/rtd_dark.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/js/external-hyperlinks.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="XTEA" href="XTEA.html" />
    <link rel="prev" title="Network Encryption" href="Encryption.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../../index.html" class="icon icon-home"> Wiki
            <img src="../../../../_static/128_icon.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Wiki</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Topics</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../Encryption/index.html">Encryption</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Encryption/hybrid_cript.html">HybridCrypt (Type 4)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Encryption/hybrid_cript.html#summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Encryption/hybrid_cript.html#distinction">Distinction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Encryption/hybrid_cript.html#usage">Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Encryption/hybrid_cript.html#composition">Composition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Encryption/hybrid_cript_plus.html">HybridCrypt+ (Type 5)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Encryption/hybrid_cript_plus.html#summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Encryption/hybrid_cript_plus.html#distinction">Distinction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Encryption/hybrid_cript_plus.html#composition">Composition</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Formats/index.html">Formats</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Formats/Map/index.html">Map</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Map/Chunk/index.html">Chunk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Map/index.html#directory-composition">Directory Composition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Formats/Scripts/index.html">Script</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Scripts/Base.html">Script Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Scripts/Property.html">Property</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Scripts/Sub.html">Sub Format (.sub)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Formats/Entity/index.html">Entity</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Entity/Models/index.html">Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Entity/Motion.html">Motion Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Entity/Effect.html">Effect Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Entity/Sound.html">Sound Data</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Formats/Pack/index.html">Pack</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Pack/eter.html">EterPack</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Formats/Protos/index.html">Protos</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Protos/Item.html">Item Proto</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Protos/Mob.html">Mob Proto</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Formats/Deprecated/index.html">Deprecated</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Deprecated/texture_caching.html">DDS Texture Caching</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Formats/Encrypted-Object.html">Encrypted Object</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Encrypted-Object.html#header">Header</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Encrypted-Object.html#data-compression">Data Compression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/Encrypted-Object.html#data-encryption">Data Encryption</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Networking</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../Flow.html">Flow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Flow.html#concept">Concept</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Phases.html">Phases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Phases.html#login-phase">Login Phase</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Synchronization/index.html">Synchronization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Synchronization/Handshake.html">Handshake</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Synchronization/IPE.html">IPE</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Data/index.html">Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Data/Packets/index.html">Packets</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Encryption</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="Overview.html">Encryption</a></li>
<li class="toctree-l4"><a class="reference internal" href="Encryption.html">Network Encryption</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">IPE</a></li>
<li class="toctree-l4"><a class="reference internal" href="XTEA.html">XTEA</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../Knowledge/index.html">Knowledge</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../Knowledge/Compatibility/index.html">Compatibility</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../Knowledge/Compatibility/improvements.html">Possible Improvements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Knowledge/Compatibility/improvements.html#id1"></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../Knowledge/Compatibility/index.html#compatible-platforms">Compatible Platforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Knowledge/Compatibility/index.html#client">Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Knowledge/Compatibility/index.html#server">Server</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../Knowledge/Compatibility/index.html#freebsd">FreeBSD</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Knowledge/Compatibility/index.html#bsd-extensions-file-monitoring">BSD Extensions/File Monitoring</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../Knowledge/Compatibility/index.html#windows">Windows</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../Knowledge/Tutorials/index.html">Tutorials</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../Knowledge/ThirdParty/index.html">Third Party</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../Knowledge/ThirdParty/Requirements.html">Tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Knowledge/ThirdParty/Requirements.html#introduction">Introduction</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../Knowledge/ThirdParty/libraries.html">Third Party Libraries</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../Knowledge/ThirdParty/libraries.html#introduction">Introduction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Knowledge/ThirdParty/libraries.html#client">Client</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Knowledge/ThirdParty/libraries.html#server">Server</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../Knowledge/ThirdParty/dependencies.html">Dependencies</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Knowledge/ThirdParty/dependencies.html#client-binary">Client Binary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Knowledge/ThirdParty/dependencies.html#directx-8-and-windows-32bit-native-apis">DirectX 8 and Windows 32bit native APIs</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">History</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../History/index.html">About</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../History/Network.html">Network</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../History/Network.html#encryption">Encryption</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../History/Network.html#methods">Methods</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../About/index.html">About</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../About/Contributing.html">Contributing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../About/Contributing.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../About/Contributing.html#content">Content</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../About/Contributing.html#proposing-changes">Proposing Changes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../About/Contributing.html#pull-requests-approval">Pull Requests / Approval</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../About/Contributing.html#licensing">Licensing</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Wiki</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">Topics</a> &raquo;</li>
          <li><a href="../index.html">Networking</a> &raquo;</li>
          <li><a href="index.html">Encryption</a> &raquo;</li>
      <li>IPE</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/Metin2-Dev/wiki-beta-dev/blob/beta/docs/pages/Topics/Networking/Encryption/IPE.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="ipe">
<h1>IPE<a class="headerlink" href="#ipe" title="Permalink to this heading"></a></h1>
<p>Diffie-Hellman key exchange</p>
<p>The improved packet encryption is performed by choosing a suitable cipher
based from the shared secret that is exchanged with Diffie-Hellman.</p>
<div class="section" id="unified-diffie-hellman-key-exchange">
<h2>Unified Diffie-Hellman key exchange<a class="headerlink" href="#unified-diffie-hellman-key-exchange" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>Initialize RFC 5114’s 1024-bit MODP standarized parameters (p, g, q)</p></li>
<li><p>Randomly generate a Static and Ephemeral public and private keys with Unified Diffie-Hellman.</p></li>
<li><p>Pass the shared secret length and public keys to the network and perform an agreement with the received public keys and shared secret length.</p></li>
</ul>
<div class="section" id="cipher-selection">
<h3>Cipher selection<a class="headerlink" href="#cipher-selection" title="Permalink to this heading"></a></h3>
<div class="section" id="a">
<h4>A<a class="headerlink" href="#a" title="Permalink to this heading"></a></h4>
<p>Takes the remained of the first byte in the shared secret block with the shared
secret size. This number will determine where the first cipher number that is
stored in the shared secret block.</p>
</div>
<div class="section" id="b">
<h4>B<a class="headerlink" href="#b" title="Permalink to this heading"></a></h4>
<p>Takes the remained of the second byte in the shared secret block with the shared
secret size. This number will determine where the second cipher number that
is stored in the shared secret block.</p>
</div>
<div class="section" id="c">
<h4>C<a class="headerlink" href="#c" title="Permalink to this heading"></a></h4>
<p>Takes the remained of this two bytes generated from the secret block with the max algorithms supported and pick an algorithm.</p>
</div>
<div class="section" id="d">
<h4>D<a class="headerlink" href="#d" title="Permalink to this heading"></a></h4>
<p>The shared secret block contain the algorithm’s keys and a block data
(a random block is being used because some algorithms do not support IV),
that will be used to crypt the packets.</p>
</div>
<div class="section" id="e">
<h4>E<a class="headerlink" href="#e" title="Permalink to this heading"></a></h4>
<p>The selected cipher will be processed with CTR Mode and the generated IV</p>
</div>
<div class="section" id="f">
<h4>F<a class="headerlink" href="#f" title="Permalink to this heading"></a></h4>
<p>If the keys are generated by the server, the first cipher will be the
encryption cipher. the second will be the decryption cipher.
The keys are inverted in client side.</p>
<p>(The lengths are the default lengths assigned to the algorithm)</p>
<div class="section" id="appendix">
<h5>Appendix<a class="headerlink" href="#appendix" title="Permalink to this heading"></a></h5>
<p>Secret block content:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Start</span> <span class="n">of</span> <span class="n">shared</span> <span class="n">data</span>
<span class="n">first</span> <span class="n">key</span>
<span class="n">second</span> <span class="n">key</span>
<span class="n">non</span> <span class="n">important</span> <span class="n">data</span>
<span class="n">second</span> <span class="n">IV</span>
<span class="n">first</span> <span class="n">IV</span>
<span class="n">End</span> <span class="n">of</span> <span class="n">shared</span> <span class="n">data</span>
</pre></div>
</div>
</div>
<div class="section" id="known-algorithms">
<h5>Known Algorithms<a class="headerlink" href="#known-algorithms" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>RC6</p></li>
<li><p>MARS</p></li>
<li><p>Twofish</p></li>
<li><p>Serpent</p></li>
<li><p>CAST256</p></li>
<li><p>IDEA</p></li>
<li><p>DES-EDE2 (Triple DES)</p></li>
<li><p>Camellia</p></li>
<li><p>SEED</p></li>
<li><p>RC5</p></li>
<li><p>Blowfish</p></li>
<li><p>TEA</p></li>
<li><p>SHACAL2</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Encryption.html" class="btn btn-neutral float-left" title="Network Encryption" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="XTEA.html" class="btn btn-neutral float-right" title="XTEA" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018-2022.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>